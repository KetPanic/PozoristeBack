(function(){"use strict";var e={2178:function(e,t,r){var s=r(6369),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",[t("b-navbar",{attrs:{toggleable:"sm",type:"dark",variant:"dark"}},[t("b-navbar-brand",{attrs:{to:"/"}},[e._v("Pozoriste")]),t("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),t("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[t("b-navbar-nav",[t("b-nav-item",{attrs:{to:"/"}},[e._v("Repertoar")]),t("b-nav-item",{attrs:{to:"/Predstave"}},[e._v("Predstave")]),t("b-nav-item",{attrs:{to:"/Sale"}},[e._v("Sale")])],1),t("b-navbar-nav",{staticClass:"ml-auto"},[e.token?e._e():t("b-nav-item",{attrs:{to:"/register"}},[e._v("Registracija")]),e.token?e._e():t("b-nav-item",{attrs:{to:"/login"}},[e._v("Prijava")]),e.token?t("b-nav-item",{attrs:{to:"/profil"}},[e._v("Profil")]):e._e(),e.token?t("b-nav-item",{on:{click:function(t){return e.logout()}}},[e._v("Odjava")]):e._e()],1)],1)],1)],1),t("router-view")],1)},o=[],n=r(3822),i={name:"App",computed:{...(0,n.rn)(["token"])},mounted(){if(localStorage.token){const e={token:localStorage.token,id:localStorage.id};this.setToken(e)}},methods:{...(0,n.OI)(["removeToken","setToken"]),logout(){this.removeToken()}},sockets:{error(e){alert(e)}}},l=i,u=r(1001),m=(0,u.Z)(l,a,o,!1,null,null,null),h=m.exports,p=r(2631),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("Header",{attrs:{subtitle:"Repertoar"}}),t("Repertoire"),t("b-form",[t("b-form-input",{staticClass:"mr-sm-2",attrs:{size:"sm",placeholder:"Search"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}}),t("b-button",{staticClass:"my-2 my-sm-0",attrs:{size:"sm",type:"submit"},on:{click:e.search}},[e._v("Pretrazi")]),t("b-button",{staticClass:"my-2 my-sm-0",attrs:{size:"sm",type:"submit"},on:{click:e.res}},[e._v("Resetuj pretragu")])],1)],1)},c=[],f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hello"},[t("h1",[e._v(e._s(e.msg))]),e._m(0),t("h3",[e._v("Installed CLI Plugins")]),e._m(1),t("h3",[e._v("Essential Links")]),e._m(2),t("h3",[e._v("Ecosystem")]),e._m(3)])},v=[function(){var e=this,t=e._self._c;return t("p",[e._v(" For a guide and recipes on how to configure / customize this project,"),t("br"),e._v(" check out the "),t("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-cli documentation")]),e._v(". ")])},function(){var e=this,t=e._self._c;return t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[e._v("babel")])]),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-router",target:"_blank",rel:"noopener"}},[e._v("router")])]),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-vuex",target:"_blank",rel:"noopener"}},[e._v("vuex")])])])},function(){var e=this,t=e._self._c;return t("ul",[t("li",[t("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Core Docs")])]),t("li",[t("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Forum")])]),t("li",[t("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Community Chat")])]),t("li",[t("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[e._v("Twitter")])]),t("li",[t("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("News")])])])},function(){var e=this,t=e._self._c;return t("ul",[t("li",[t("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-router")])]),t("li",[t("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vuex")])]),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[e._v("vue-devtools")])]),t("li",[t("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-loader")])]),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[e._v("awesome-vue")])])])}],g={name:"HelloWorld",props:{msg:String}},b=g,w=(0,u.Z)(b,f,v,!1,null,"1935ec24",null),_=(w.exports,function(){var e=this,t=e._self._c;return t("div",[t("b-pagination",{attrs:{"total-rows":e.repertoireIds.length,"per-page":e.perPage,"aria-controls":"image-table"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),t("b-table",{attrs:{id:"image-table",hover:"",fixed:"",items:e.items,fields:e.fields,small:"","per-page":e.perPage,"current-page":e.currentPage},on:{"row-clicked":e.rowClicked}}),t("b-pagination",{attrs:{"total-rows":e.repertoireIds.length,"per-page":e.perPage,"aria-controls":"image-table"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)}),k=[],y={name:"Repertoire",data(){return{fields:[{key:"show.name",label:"Naziv"},{key:"hall.name",label:"Sala"},{key:"dateTime",label:"Datum"},{key:"time",label:"Vreme"}],items:[],currentPage:1,perPage:5}},computed:{...(0,n.rn)(["repertoireIds"])},watch:{currentPage(e,t){this.repertoireIds.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage).map((e=>{this.getRepertoireEntry(e).then((e=>this.items.push(e)))}))},repertoireIds(e,t){this.currentPage=1,this.items=[],e.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage).map((e=>{this.getRepertoireEntry(e).then((e=>this.items.push(e)))}))}},mounted(){this.repertoireIds.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage).map((e=>{this.getRepertoireEntry(e).then((e=>this.items.push(e)))}))},methods:{...(0,n.nv)(["getRepertoireEntry"]),rowClicked(e,t){this.$router.push({name:"RepertoireEntry",params:{id:e.id,name:e.show.name}})}}},P=y,I=(0,u.Z)(P,_,k,!1,null,"95b8e4b0",null),S=I.exports,R=function(){var e=this,t=e._self._c;return t("div",{staticClass:"naslov"},[e.subtitle?t("h1",[e._v(e._s(e.subtitle))]):e._e()])},j=[],x={name:"Header",props:{subtitle:String}},T=x,E=(0,u.Z)(T,R,j,!1,null,"037e90b4",null),$=E.exports,D={name:"HomeView",data(){return{searchQuery:""}},components:{Repertoire:S,Header:$},methods:{...(0,n.nv)(["fetchRepertoireIds","fetchRepertoireIdsQuery"]),search(e){e.preventDefault();const t=this.searchQuery;this.searchQuery="",this.fetchRepertoireIdsQuery(t)},res(e){e.preventDefault(),this.fetchRepertoireIds()}},mounted(){this.fetchRepertoireIds()}},C=D,H=(0,u.Z)(C,d,c,!1,null,null,null),O=H.exports,z=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Header",{attrs:{subtitle:"Prijavite se"}}),t("b-form",{on:{submit:e.onSubmit}},[t("b-form-group",{attrs:{label:"User Name:","label-for":"username"}},[t("b-form-input",{attrs:{id:"username",placeholder:"Enter name",required:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("b-form-group",{attrs:{label:"Password:","label-for":"password"}},[t("b-form-input",{attrs:{id:"password",type:"password",required:""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1)],1)},Z=[],U={name:"Login",components:{Header:$},data(){return{form:{username:"",password:""}}},methods:{...(0,n.nv)(["login"]),onSubmit(e){e.preventDefault(),this.form.username.length<1?alert("Username can't be null"):this.form.password.length<4?alert("Password must be at least 4 characters long"):this.login(this.form).then((e=>{e?this.$router.push({name:"home"}):this.form.password=""}))}}},N=U,q=(0,u.Z)(N,z,Z,!1,null,"23cd9f39",null),B=q.exports,Q=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Header",{attrs:{subtitle:"Registrujte se"}}),t("b-form",{on:{submit:e.onSubmit}},[t("b-form-group",{attrs:{label:"Email address:","label-for":"email"}},[t("b-form-input",{attrs:{id:"email",type:"email",placeholder:"Enter email",required:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("b-form-group",{attrs:{label:"Username:","label-for":"username"}},[t("b-form-input",{attrs:{id:"username",placeholder:"Enter username",required:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("b-form-group",{attrs:{label:"Password:","label-for":"password"}},[t("b-form-input",{attrs:{id:"password",type:"password",required:""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("b-form-group",{attrs:{label:"Repeat password:","label-for":"repeatPassword"}},[t("b-form-input",{attrs:{id:"repeatPassword",type:"password",required:""},model:{value:e.repeatPassword,callback:function(t){e.repeatPassword=t},expression:"repeatPassword"}})],1),t("b-form-group",{attrs:{label:"Name:","label-for":"name"}},[t("b-form-input",{attrs:{id:"name",placeholder:"Enter name",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("b-form-group",{attrs:{label:"Surname:","label-for":"surname"}},[t("b-form-input",{attrs:{id:"surname",placeholder:"Enter surname",required:""},model:{value:e.form.surname,callback:function(t){e.$set(e.form,"surname",t)},expression:"form.surname"}})],1),t("br"),t("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1)],1)},A=[],F={name:"Register",components:{Header:$},data(){return{form:{email:"",username:"",password:"",name:"",surname:"",type:2},repeatPassword:""}},methods:{...(0,n.nv)(["register"]),onSubmit(e){e.preventDefault(),this.form.password!=this.repeatPassword?alert("Passwords don't match"):this.form.password.length<4?alert("Password must be at least 4 characters long"):this.register(this.form).then((e=>{e&&this.$router.push({name:"Home"})}))}}},V=F,L=(0,u.Z)(V,Q,A,!1,null,"869b0fe4",null),M=L.exports,J=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("Header",{attrs:{subtitle:"Predstave"}}),0!=e.showIds.length?t("b-card-group",e._l(e.showIds,(function(r){return t("div",{key:r,on:{click:function(t){return e.redir(r)}}},[t("ShowTile",{attrs:{id:r}})],1)})),0):e._e()],1)},G=[],K=function(){var e=this,t=e._self._c;return t("div",[e.gotItem?t("div",[t("b-card",{attrs:{title:e.item.name,"img-src":e.image,"img-alt":"Image","img-top":""}})],1):e._e()])},W=[],X={name:"ShowTile",props:{id:Number},data(){return{item:{},gotItem:!1,image:""}},watch:{id(e,t){this.getShowEntry(this.id).then((e=>{this.item=e,this.image="data:image/jpeg;base64,"+e.poster,this.gotItem=!0}))}},mounted(){this.getShowEntry(this.id).then((e=>{this.item=e,this.image="data:image/jpeg;base64,"+e.poster,this.gotItem=!0}))},methods:{...(0,n.nv)(["getShowEntry"])}},Y=X,ee=(0,u.Z)(Y,K,W,!1,null,null,null),te=ee.exports,re={name:"Shows",components:{ShowTile:te,Header:$},computed:{...(0,n.rn)(["showIds"])},methods:{...(0,n.nv)(["fetchShowIds"]),redir(e){this.$router.push({name:"ShowView",params:{id:e}})}},mounted(){this.fetchShowIds()}},se=re,ae=(0,u.Z)(se,J,G,!1,null,null,null),oe=ae.exports,ne=function(){var e=this,t=e._self._c;return t("div",[t("Header",{attrs:{subtitle:"Sale"}}),t("div",{staticClass:"home"},[t("b-list-group",e._l(e.halls,(function(e){return t("div",[t("Hall",{attrs:{hall:e}})],1)})),0)],1)],1)},ie=[],le=function(){var e=this,t=e._self._c;return t("div",[t("b-list-group-item",{staticClass:"item flex-column align-items-start",attrs:{href:"#"}},[t("div",{staticClass:"w-100 justify-content-between"},[e.hall?t("h3",[e._v(e._s(e.hall.name))]):e._e(),e.hall?t("p",[e._v("Broj sedista: "+e._s(e.hall.noOfSeats))]):e._e(),t("h4",[e._v("Opis sale:")]),e.hall?t("p",[e._v(e._s(e.hall.description))]):e._e()])])],1)},ue=[],me={name:"Header",props:{hall:{},gotData:!1}},he=me,pe=(0,u.Z)(he,le,ue,!1,null,"4fa8bb98",null),de=pe.exports,ce={name:"Halls",components:{Hall:de,Header:$},computed:{...(0,n.rn)(["halls"])},methods:{...(0,n.nv)(["fetchHalls"])},mounted(){this.fetchHalls()}},fe=ce,ve=(0,u.Z)(fe,ne,ie,!1,null,"c8f50a5e",null),ge=ve.exports,be=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Header",{attrs:{subtitle:e.subtitle}}),e.gotData?t("div",[t("Show",{attrs:{rep:e.rep}}),t("p",[e._v("Datum: "+e._s(e.rep.dateTime))]),t("p",[e._v("Vreme: "+e._s(e.rep.time))]),t("div",{attrs:{"v-if":e.token}}),e.token&&e.gotTickets?t("div",[t("hr"),t("h4",[e._v("Rezervisite karte:")]),t("p",[e._v("Izaberite tip:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.chosen,expression:"chosen"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.chosen=t.target.multiple?r:r[0]}}},e._l(e.tickets,(function(r){return t("option",{domProps:{value:r}},[e._v(e._s(r.ticketType.name)+" - "+e._s(r.ticketType.price))])})),0),t("div",[t("p",[e._v("Izaberite kolicinu:")]),t("b-form",{attrs:{inline:""},on:{submit:e.onSubmit}},[t("label",{staticClass:"sr-only",attrs:{for:"inline-form-input-name"}},[e._v("Name")]),t("b-form-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{type:"number",id:"inline-form-input-name",disabled:e.disableInput,max:e.number,min:"0"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),t("b-button",{attrs:{variant:"primary",type:"submit",disabled:e.disableButton}},[e._v("Rezervisi")])],1)],1),t("hr")]):t("div",[e._v(" Ulogujte se da biste rezervisali kartu ")])],1):e._e(),t("hr"),e.gotData?t("div",[t("Comments",{attrs:{showId:e.rep.showId}})],1):e._e(),t("br"),t("hr")],1)},we=[],_e=function(){var e=this,t=e._self._c;return t("div",[t("h4",[e._v("Komentari")]),e.token?t("div",[t("b-form-input",{attrs:{placeholder:"Napisite nesto..."},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1):t("p",[e._v("Morate biti prijavljeni da biste ostavili komentar")]),e._l(e.show.comments,(function(r){return t("b-card",{key:r.id,attrs:{title:r.user.username}},[t("b-card-text",[e._v(" "+e._s(r.text)+" ")])],1)})),t("hr"),t("br")],2)},ke=[],ye={name:"Comments",props:{showId:Number},data(){return{comment:"",show:{}}},computed:{...(0,n.rn)(["token","id"])},mounted(){this.getShowEntry(this.showId).then((e=>this.show=e))},methods:{...(0,n.nv)(["postComment","getShowEntry"]),onSubmit(){this.$socket.emit("comment",{text:this.comment,showId:this.show.id,userId:this.id,token:this.token}),this.comment=""}}},Pe=ye,Ie=(0,u.Z)(Pe,_e,ke,!1,null,"cad452d4",null),Se=Ie.exports,Re=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[e.gotData?t("div",{on:{onclick:function(e){}}},[t("p",{attrs:{"v-if":e.rep.show}},[e._v(e._s(e.rep.show.description))]),t("img",{attrs:{src:e.image}})]):e._e()])},je=[],xe={name:"Show",props:{rep:{}},data(){return{image:"",gotData:!1}},watch:{rep(e,t){this.image="data:image/jpeg;base64,"+e.show.image}},mounted(){this.image="data:image/jpeg;base64,"+this.rep.show.image,this.gotData=!0},methods:{...(0,n.nv)(["getRepertoireEntry"])}},Te=xe,Ee=(0,u.Z)(Te,Re,je,!1,null,"5915aa96",null),$e=Ee.exports,De={name:"RepertoireEntry",components:{Header:$,Comments:Se,Show:$e},computed:{...(0,n.rn)(["token","id"])},data(){return{subtitle:"",repID:null,rep:{},tickets:{},chosen:{},disableInput:!0,disableButton:!0,value:0,number:0,show:null,image:"",gotData:!1,gotTickets:!1}},watch:{$route(){this.subtitle=this.$route.params.name,this.repID=this.$route.params.id,this.getRepertoireEntry(this.repID).then((e=>{this.rep=e,this.image="data:image/jpeg;base64,"+e.show.image,this.gotData=!0})),this.getTickets(this.repID).then((e=>{this.tickets=e,this.gotTickets=!0}))},chosen(e,t){null!=e?(this.disableInput=!1,this.value=0,this.number=e.number):(this.disableInput=!0,this.disableButton=!0)},value(e,t){0!=e&&e<=this.number?this.disableButton=!1:this.disableButton=!0}},mounted(){this.subtitle=this.$route.params.name,this.repID=this.$route.params.id,this.getRepertoireEntry(this.repID).then((e=>{this.rep=e,this.image="data:image/jpeg;base64,"+e.show.image,this.gotData=!0})),this.getTickets(this.repID).then((e=>{this.tickets=e,this.gotTickets=!0}))},methods:{...(0,n.nv)(["getRepertoireEntry","getTickets","reserveTickets"]),onSubmit(e){e.preventDefault();const t={noOfTickets:this.value,userId:this.id,ticketId:this.chosen.id};this.reserveTickets(t).then((e=>{e&&(this.tickets.forEach((e=>{e.id==t.ticketId&&(e.number=e.number-t.noOfTickets)})),this.chosen=null)}))}}},Ce=De,He=(0,u.Z)(Ce,be,we,!1,null,"3d6f6c14",null),Oe=He.exports,ze=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[e.gotData?t("div",[t("Header",{attrs:{subtitle:e.subtitle}}),t("Show",{attrs:{rep:e.rep}}),t("hr"),t("Repertoire"),t("hr"),t("Comments",{attrs:{showId:e.rep.show.id}})],1):e._e()])},Ze=[],Ue={name:"ShowView",components:{Header:$,Comments:Se,Show:$e,Comments:Se,Repertoire:S},computed:{...(0,n.rn)(["token","id"])},data(){return{subtitle:"",repID:null,rep:{},show:null,image:"",gotData:!1}},watch:{$route(){this.repID=this.$route.params.id,this.getRepertoireEntry(this.repID).then((e=>{this.rep=e,this.image="data:image/jpeg;base64,"+e.show.image,this.subtitle=e.show.name,this.fetchRepertoireIdsForShow(e.show.id),this.gotData=!0}))}},mounted(){this.repID=this.$route.params.id,this.getRepertoireEntry(this.repID).then((e=>{this.rep=e,this.image="data:image/jpeg;base64,"+e.show.image,this.subtitle=e.show.name,this.fetchRepertoireIdsForShow(e.show.id),this.gotData=!0}))},methods:{...(0,n.nv)(["getRepertoireEntry","fetchRepertoireIdsForShow"])}},Ne=Ue,qe=(0,u.Z)(Ne,ze,Ze,!1,null,"03753e15",null),Be=qe.exports,Qe=function(){var e=this,t=e._self._c;return t("div",[t("Header",{attrs:{subtitle:"Profil"}}),t("ProfileInfo"),t("br"),t("UserReservations")],1)},Ae=[],Fe=function(){var e=this,t=e._self._c;return t("div",[e.gotData?t("div",[t("b-card",{attrs:{title:e.user.username,"sub-title":e.user.email}},[t("br"),t("b-card-text",[e._v(" Ime: "+e._s(e.user.name)+" ")]),t("b-card-text",[e._v("Prezime: "+e._s(e.user.surname))]),t("a",{staticClass:"card-link",attrs:{href:"izmenaProfila"}},[e._v("Izmeni profil")])],1)],1):e._e()])},Ve=[],Le={name:"ProfileInfo",data(){return{gotData:!1}},computed:{...(0,n.rn)(["token","id","user"])},methods:{...(0,n.nv)(["getUser"])},mounted(){localStorage.getItem("token")||this.$router.push({name:"home"}),this.getUser().then((e=>{e?this.gotData=!0:this.$router.push({name:"home"})}))}},Me=Le,Je=(0,u.Z)(Me,Fe,Ve,!1,null,null,null),Ge=Je.exports,Ke=function(){var e=this,t=e._self._c;return t("div",[t("h2",[e._v("Rezervacije")]),t("hr"),e._l(e.res,(function(r){return t("div",{key:r.id,staticClass:"cont"},[e.gotData?t("div",[t("b-card",{attrs:{title:r.show.show.name,"sub-title":r.show.hall.name}},[t("br"),t("b-card-text",[e._v(" Datum: "+e._s(r.show.dateTime)+" ")]),t("b-card-text",[e._v("Vreme: "+e._s(r.show.time))]),t("b-card-text",[e._v("Broj karata: "+e._s(r.noOfTickets))]),t("b-button",{on:{click:function(t){return e.delRes(r.id)}}},[e._v("Otkazi rezervaciju")])],1)],1):e._e(),t("hr")])}))],2)},We=[],Xe={name:"UserResrvations",computed:{...(0,n.rn)(["reservations","token"])},data(){return{res:[],counter:0,gotData:!1}},methods:{...(0,n.nv)(["getReservations","getRepertoireEntry","deleteReservation"]),delRes(e){this.deleteReservation(e).then((e=>{location.reload()}))}},watch:{token(e,t){this.getReservations()},res(e,t){e.forEach((e=>{this.getRepertoireEntry(e.ticket.repertoireId).then((t=>{e.show=t,this.counter++,this.counter==this.res.length&&(this.gotData=!0)}))}))}},mounted(){this.getReservations().then((e=>{this.res=e}))}},Ye=Xe,et=(0,u.Z)(Ye,Ke,We,!1,null,null,null),tt=et.exports,rt={name:"Profile",components:{Header:$,ProfileInfo:Ge,UserReservations:tt,UserReservations:tt},computed:{...(0,n.rn)(["token"])},watch:{token(e,t){localStorage.getItem("token")||this.$router.push({name:"home"})}},mounted(){localStorage.getItem("token")||this.$router.push({name:"home"})}},st=rt,at=(0,u.Z)(st,Qe,Ae,!1,null,null,null),ot=at.exports,nt=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Header",{attrs:{subtitle:"Izmeni profil"}}),t("b-form",{on:{submit:e.onSubmit}},[t("b-form-group",{attrs:{label:"Password:","label-for":"password"}},[t("b-form-input",{attrs:{id:"password",type:"password",required:""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("b-form-group",{attrs:{label:"Repeat password:","label-for":"repeatPassword"}},[t("b-form-input",{attrs:{id:"repeatPassword",type:"password",required:""},model:{value:e.repeatPassword,callback:function(t){e.repeatPassword=t},expression:"repeatPassword"}})],1),t("b-form-group",{attrs:{label:"Name:","label-for":"name"}},[t("b-form-input",{attrs:{id:"name",placeholder:"Enter name",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("b-form-group",{attrs:{label:"Surname:","label-for":"surname"}},[t("b-form-input",{attrs:{id:"surname",placeholder:"Enter surname",required:""},model:{value:e.form.surname,callback:function(t){e.$set(e.form,"surname",t)},expression:"form.surname"}})],1),t("br"),t("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1)],1)},it=[],lt={name:"ProfileEdit",components:{Header:$},data(){return{form:{email:"",username:"",password:"",name:"",surname:"",type:2},repeatPassword:""}},computed:{...(0,n.rn)(["user"])},mounted(){localStorage.getItem("token")||this.$router.push({name:"home"}),this.getUser().then((e=>{this.form.email=this.user.email,this.form.username=this.user.username,this.form.name=this.user.name,this.form.surname=this.user.surname,this.form.type=this.user.type}))},methods:{...(0,n.nv)(["register","getUser","editUser"]),onSubmit(e){e.preventDefault(),this.form.password!=this.repeatPassword?alert("Passwords don't match"):this.form.password.length<4?alert("Password must be at least 4 characters long"):this.editUser(this.form).then((e=>{e&&this.$router.push({name:"Login"})}))}}},ut=lt,mt=(0,u.Z)(ut,nt,it,!1,null,"34e0f9ef",null),ht=mt.exports;s["default"].use(p.Z);const pt=[{path:"/",name:"home",component:O},{path:"/predstave",name:"Shows",component:oe},{path:"/profil",name:"Profile",component:ot},{path:"/izmenaProfila",name:"ProfileEdit",component:ht},{path:"/predstava/:id",name:"ShowView",component:Be},{path:"/sale",name:"Halls",component:ge},{path:"/predstavaRepertoar/:id/:name",name:"RepertoireEntry",component:Oe},{path:"/login",name:"Login",component:B},{path:"/register",name:"Register",component:M}],dt=new p.Z({mode:"history",base:"/",routes:pt});var ct=dt,ft=r(5996),vt=r(9425),gt=r(9557),bt=r.n(gt);r(7024);s["default"].use(n.ZP);var wt=new n.ZP.Store({state:{token:"",repertoireIds:[],repertoire:[],showIds:[],shows:[],halls:[],id:-1,user:{},reservations:[]},getters:{},mutations:{setToken(e,t){e.token=t.token,localStorage.token=t.token,e.id=t.id,localStorage.id=t.id},removeToken(e){e.token="",e.id=-1,localStorage.token="",localStorage.id=-1},addRepertoireIds(e,t){e.repertoireIds=t},addRepertoire(e,t){e.repertoire.push(t)},addShowIds(e,t){e.showIds=t},addShow(e,t){e.shows.push(t)},addHalls(e,t){e.halls=t},addComment(e,t){const r=e.shows.filter((e=>e.id==t.showId))[0];r&&r.comments.push(t.comment)},addUser(e,t){e.user=t},addReservations(e,t){e.reservations=t},addMoreRepertoireIds(e,t){e.repertoireIds.push(t)}},actions:{reserveTickets({commit:e,state:t},r){return new Promise(((e,s)=>{fetch("https://restlp.herokuapp.com/reservations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},body:JSON.stringify(r)}).then((e=>e.json())).then((t=>{t.message?(alert(t.message),e(!1)):(alert("Rezervisano!"),e(!0))}))}))},getTickets({commit:e,state:t},r){return new Promise(((e,t)=>{fetch(`https://restlp.herokuapp.com/tickets/repertoireEntry/${r}`).then((e=>e.json())).then((t=>{e(t)}))}))},getUser({commit:e,state:t}){return new Promise(((t,r)=>{fetch(`https://restlp.herokuapp.com/users/${localStorage.id}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.token}`}}).then((e=>e.json())).then((r=>{r.message?(alert(r.message),t(!1)):(e("addUser",r),t(!0))}))}))},getReservations({commit:e,state:t}){return new Promise(((t,r)=>{fetch(`https://restlp.herokuapp.com/reservations/forUser/${localStorage.id}`).then((e=>e.json())).then((r=>{r.message?(alert(r.message),t([])):(e("addReservations",r),t(r))}))}))},deleteReservation({commit:e,state:t},r){return new Promise(((e,t)=>{fetch(`https://restlp.herokuapp.com/reservations/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.token}`}}).then((e=>e.json())).then((t=>{t.message?(alert(t.message),e([])):e([])}))}))},getRepertoireEntry({commit:e,state:t},r){return new Promise(((s,a)=>{const o=t.repertoire.filter((e=>e.id==r))[0];o?s(o):fetch(`https://restlp.herokuapp.com/repertoire/${r}`).then((e=>e.json())).then((t=>{e("addRepertoire",t),s(t)}))}))},fetchShowIds({commit:e}){fetch("https://restlp.herokuapp.com/shows/ids").then((e=>e.json())).then((t=>e("addShowIds",t)))},fetchHalls({commit:e}){fetch("https://restlp.herokuapp.com/halls").then((e=>e.json())).then((t=>e("addHalls",t)))},getShowEntry({commit:e,state:t},r){return new Promise(((s,a)=>{const o=t.shows.filter((e=>e.id==r))[0];o?s(o):fetch(`https://restlp.herokuapp.com/shows/${r}`).then((e=>e.json())).then((t=>{fetch(`https://restlp.herokuapp.com/comments/${r}`).then((e=>e.json())).then((r=>{const a=t;a.comments=r,e("addShow",a),s(a)}))}))}))},fetchRepertoireIds({commit:e}){fetch("https://restlp.herokuapp.com/repertoire/ids").then((e=>e.json())).then((t=>e("addRepertoireIds",t)))},fetchRepertoireIdsQuery({commit:e},t){fetch(`https://restlp.herokuapp.com/shows/query/${t}`).then((e=>e.json())).then((t=>{e("addRepertoireIds",[]),t.forEach((t=>{fetch(`https://restlp.herokuapp.com/repertoire/ids/${t}`).then((e=>e.json())).then((t=>e("addMoreRepertoireIds",t)))}))}))},fetchRepertoireIdsForShow({commit:e},t){fetch(`https://restlp.herokuapp.com/repertoire/ids/${t}`).then((e=>e.json())).then((t=>e("addRepertoireIds",t)))},editUser({commit:e},t){return new Promise(((r,s)=>{fetch(`https://restlp.herokuapp.com/users/${localStorage.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.token}`},body:JSON.stringify(t)}).then((e=>e.json())).then((t=>{t.message?(alert(t.message),r(!1)):(e("removeToken"),alert("Uspesno izmenjen profil. Ulogujte se"),r(!0))}))}))},register({commit:e},t){return new Promise(((r,s)=>{fetch("https://authkp.herokuapp.com/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((t=>{t.token?(e("setToken",t),r(!0)):(alert(t[0].message),r(!1))}))}))},login({commit:e},t){return new Promise(((r,s)=>{fetch("https://authkp.herokuapp.com/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((t=>{t.token?(e("setToken",t),r(!0)):(alert(t.message),r(!1))}))}))},socket_comment({commit:e},t){const r=JSON.parse(t);e("addComment",{showId:r.showId,comment:r})}},modules:{}});s["default"].use(ft.XG7),s["default"].use(vt.A7),s["default"].use(new(bt())({debug:!1,connection:"https://restlp.herokuapp.com/",vuex:{store:wt,actionPrefix:"socket_"}})),s["default"].config.productionTip=!1,new s["default"]({router:ct,store:wt,render:e=>e(h)}).$mount("#app")}},t={};function r(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,r),o.exports}r.m=e,function(){var e=[];r.O=function(t,s,a,o){if(!s){var n=1/0;for(m=0;m<e.length;m++){s=e[m][0],a=e[m][1],o=e[m][2];for(var i=!0,l=0;l<s.length;l++)(!1&o||n>=o)&&Object.keys(r.O).every((function(e){return r.O[e](s[l])}))?s.splice(l--,1):(i=!1,o<n&&(n=o));if(i){e.splice(m--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var m=e.length;m>0&&e[m-1][2]>o;m--)e[m]=e[m-1];e[m]=[s,a,o]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var a,o,n=s[0],i=s[1],l=s[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(l)var m=l(r)}for(t&&t(s);u<n.length;u++)o=n[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(m)},s=self["webpackChunkpozoristefront"]=self["webpackChunkpozoristefront"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(2178)}));s=r.O(s)})();
//# sourceMappingURL=app.516f2e15.js.map